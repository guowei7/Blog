---
title: "C语言基础"
date: 2020-08-16T13:13:46+08:00
Description: "主要是看C primer plus总结"
Tags: ["C"]
Categories: ["编程语言"]
DisableComments: false
---
本文主要为学习《C primer  plus》进行的总结
<!--more-->
### 1. 初识C语言
#### C语言的7个步骤  
1. 定义程序的目标  
    思考你的程序需要哪些信息，要进行那些计算和控制，以及程序要报告什么信息。  
2. 设计程序  
    主要的一点就是程序中的数据如何表示，以及用什么方法来处理数据。
3. 编写代码  
    把设计好的思路用C语言实现，注意要添加正确的文字注释。  
4. 编译  
    编译取决于环境，编译器是把源代码转换成可执行代码的程序。可执行代码是用机器语言表示的代码，由数字码表示的指令组成。通常C编译器还将源代码和C库的代码合并成最终的程序(准确来说是用链接器来链接库函数)。  
5. 运行程序  
    在常见环境中运行程序要输入可执行文件的文件名，其他环境核能要运行命令。
6. 测试和调试程序  
    发现程序中的错误(bug),查找并修复程序错误的过程叫调试。  
7. 维护和修改代码  
    主要是程序有错或需要扩展程序用途的时候，就需要修改程序。  
#### 编程机制  
C编程的基本策略是，用程序把源代码文件转换为可执行文件。典型的C实现通过编译和链接两个步骤来完成。编译器把源代码转换成中间代码，链接器把中间代码和其他代码合并，生成可执行文件。可以独立编译单独的模块，稍后再用链接器合并已编译的模块，这样在只更改了某个模块时，不必重新编译其他模块。  
中间文件有多种形式。最普遍的一种形式是吧源代码转换成机器语言代码，并把结果放在目标代码文件中。但目标文件不能直接运行，并不是一个完整的程序。  
目标代码文件缺失启动代码，启动代码充当着程序和操作系统之间的接口。目标文件还缺少库函数，许多函数的目标代码在库文件中。链接器的作用是把你编写的目标代码、系统的标准启动代码和库代码三部分合成一个文件，即可执行文件。对于库代码，链接器只会把程序中要用的库函数代码提取出来如下图:
![C-编译器和链接器](../../images/C-Learning/C-编译器和链接器.png)  
#### GNU编译器合集  
GNU编译器合集也被称为GCC，其中包含GCC C编译器。可以根据不同的版本选择运行时调用不同C标准  
``` shell
gcc -std=c99 inform.c  //调用C99标准
gcc -std=clx inform.c  //接受C11之前的草案标准
gcc -std=cll inform.c  //接受C11标准
```  
gcc的编译过程包含如下步骤：  
``` shell  
#预处理，不进行编译、汇编、链接
gcc -E first.c -o first.i  
#将预处理后的文件进行编译，生成汇编文件
gcc -S first.i -o first.s  
#将汇编文件进行汇编生成目标文件(机器语言)  
gcc -c first.s -o first.o  
#将目标文件同系统库的obj文件、库文件连接成平台可执行的文件
gcc first.o -o first  
```
### 2. C 语言概述
#### 简单的C程序  
[first.c](../../c-example/first.c)
```C  
#include<stdio.h>

int main(void)
{
    int num;
    num = 1;
    printf("I am a simple");
    printf("computer.\n");
    printf("My favorite number is %d because it is first.\n", num);
    getchar();
    return 0;
}  
```  
1. #include指令和头文件  
    #include<stdio.h>这是程序的第一行，相当于把stdio.h中的所有内容都输入该行所在的位置。实际上，这是一种“拷贝-粘贴”的操作。  
    #include这行代码是一条C预处理指令(preprocessor directive)。通常，在C程序顶部的信息集合被称为头文件，在大多数情况下，头文件包含了编译器创建最终可执行程序要用到的信息。例如，头文件中可以定义一些常量，或者指明函数名及如何使用它们。但是函数的实际代码在一个预编译代码的库文件中。  
2. main()函数  
    int main(void)  C程序一定从main()函数开始执行(目前不必考虑例外情况)。int是main()函数的返回类型，这表明main()函数返回的值是整数。通常函数名后面的圆括号中包含一些传入函数的信息。该例中没有传递任何信息。因此，圆括号内饰单词void。  
3. 注释  
    /\*一个简单的程序\*/  
    在程序中，被/\* /\*两个符号括起来的部分是程序的注释。写注释能让他人(自己)更容易明白你你所写的程序。C99新增了另一种风格的注释，使用//符号创建注释，仅限于单行。  
4. 花括号、函数体和块  
    花括号把main()函数括起来。一般而言，所有的C函数都使用花括号标记函数体的开始和结尾。这是规定，不能省略。花括号还可用于把函数中的多条语句合并为一个单元或块。  
5. 声明  
    int num；  
    这行代码叫做声明。声明是C语言最重要的特征之一。声明完成了两件事情，一是在函数中有一个名为num的变量，二是int表明num是一个整数。int是一种数据类型。编译器使用这些信息为num变量在内存中分配存储空间。  
    int是C语言的一个关键字，表示一种基本的C语言数据类型。关键字是语言定义的单词，不能做其他用途。如用作函数名和变量名。  
    示例中的num是一个标识符，也就是一个变量、函数或其他实体的名称。因此，声明2把特定标识符与计算机内存中的特定位置联系起来，同时也确定了存储在某位置的信息类型或数据类型。C语言中，所有变量都必须先声明才能使用，这意味着必须列出程序中用到的所有变量名及其类型。
    * 数据类型  
        C语言可以处理多种类型的数据，如整数、字符和浮点数。把变量声明为整形或字符类型，计算机才能正确地存储、读取和解释数据。  
    * 命名  
        给变量命名时要使用有意义的变量名或标识符。如果变量名无法清楚地表达自身的用途，可在注释中进一步说明。这是一种良好的编程习惯和编程技巧。  
        C99和C11允许使用更长的标识符名，但是编译器只识别前63个字符，你可以使用更长的字符，但是编译器会忽略超出的字符。可以用小写字母、大写字母、数字和下划线(_)来命名。而且，名称的第一个字符必须是字符或下划线，不能是数字。操作系统和C库经常使用一个或两个下划线字符开始的标识符，因此最好避免在自己的程序中使用这样的名称。  
6. 赋值  
    num=1；  
    这行代码是赋值表达式语句。赋值是C语言的基本操作之一，改行代码的意思是把"把值1赋给变量num"。在执行int num；声明时，编译器在计算机内存中为变量预留了空间，然后在执行这行赋值表达式语句时，把值存储在之前预留的位置。  
7. printf()函数  
    圆括号表明printf是一个函数名。圆括号中的内容是从main()函数传递给printf()函数的信息。第一行吧I am a simple传递给printf()函数。该信息被称为参数或者更确切地说，是函数的实际参数，实参是传递给函数的特性值，形式参数是函数中用于存储值的变量。当程序运行到这一行时，控制权被转给已命名的函数(如printf())。函数执行结束后，控制权被返回至主调函数，如main()。  
8. return语句  
    return语句是程序中的最后一条语句。int main(void)中的int表明main函数应返回一个整数。C标准要求main()这样做。有返回值的C函数要有return语句。该语句以return关键字开始，后面是带返回的值，并以分号结尾。如果遗漏main()函数中的return语句，程序运行至最外面的右花括号时会返回0。
#### 简单程序的结构  
C程序由一个或多个函数组成，必须有main()函数，函数由函数头和函数体组成。
* 函数头包括函数名、传入该函数的信息类型和函数的返回类型。
* 函数体被花括号括起来，由一系列语句、声明组成。
####  提高程序可读性技巧  
1. 选择有意义的函数名和写注释。  
2. 在函数中用空行分隔概念上的多个部分。  
3. 尽量每条语句占一行。  
#### 进一步使用C  
[fathm_ft.c](../../c-example/fathm_ft.c)  
1. 该程序在一条声明中声明了两个变量，而不是一个变量，使用逗号隔开两个变量。  
2. 程序进行了乘法运算，使用运算符\*。  
3. 最后使用printf()函数时,进行了两次替换，并且待打印的值不一定是变量，只要可求值得出合适类型值得项即可。如6*fathoms。  
#### 多个函数  
[two_func.c](../../c-example/two_func.c)  
two.func.c程序演示了如何把自己的函数加入程序中。  
butler()函数在程序中出现了三次。第1次是函数原型(prototype),告知编译器要在程序中使用该函数；第2次以函数调用(function call)的形式出现在main中；最后一次出现在函数定义(function definition)中，函数定义即是函数本身的源代码。  
函数原型是一种声明形式，告知编译器正在使用某函数，因此函数原型也被称为函数声明(function declaration)。函数原型还指明了函数的属性。例如，butler()函数原型中的第1个void表明，butler()函数没有返回值。第二个void的意思是butler()函数不带参数。  
C标准建议，要为程序中用到的所有函数提供函数原型。标准include文件为标准库函数提供可函数原型。例如，在C标准中，stdio.h文件包含了printf()的函数原型。  
#### 调试程序  
``` C
/* nogood.c --有错误的程序 */
#include <stdio.h>  

int main(void)(
    int n,int n2, int n3;
    /* 该程序有多处错误
    n = 5;
    n2 = n * n;
    n3 = n2*n2;
    printf("n=%d,n squared = %d, n cubed = %d\n",n,n2,n3)
    return 0;
)
```  
1. 语法错误  
    上述程序中有多处语法错误。不遵循C语言的规则就会犯语法错误。其一，main()函数体使用圆括号来代替花括号。二是变量声明错误，三是注释漏掉了*/结尾。最后printf()语句末尾漏掉了分号。  
2. 语义错误  
    编译器无法检测语义错误，因为这类错误并未违反C语言的规则。编译器无法了解你的真正意图。所以你只能自己找出这些错误。  
    [stillbad.c](../../c-example/stillbad.c)  
3. 程序状态  
    通过逐步跟踪程序的执行步骤，并记录每个变量，便可监视程序的状态。程序状态(program state)是在程序的执行过程中，某给定点上所有变量值的集合。  
    定义语义错误的另一种方法是：在程序中的关键点插入额外的printf()语句，以监视制定变量值的变化。通过查看值得变化可以了解程序的执行情况，对程序的执行满意后，便可删除额外的printf()语句，然后重新编译。  
    检测程序状态的第三种方法是使用调试器。调试器(debugger)是一种程序，让你一步一步运行另一个程序，并检查该程序变量的值。调试器有不同的使用难度和复杂度。较高级的调试器会显示正在执行的源代码行号。  
4. 关键字和保留标识符  
    关键字是C语言词汇。它们对C而言比较特殊，不能用它们作为标识符。许多关键字用于指定不同的类型，如int。还有一些关键字(如if)用于控制程序中语句的执行顺序。  
### 3. 数据和C
#### 示例程序  
[platinum.c](../../c-example/platinum.c)  
即使使用第2章介绍的方法，在程序中添加下面一行代码:  
``` C
getchar();  
```
程序的输出是否依旧在屏幕上一闪而过？本例，需要调用两次getchar()函数：  
getchar()函数读取下一个输入字符，因此程序会等待用户输入。在这种情况下，键入156并按下Enter键(发送一个换行符)，然后scanf()读取键入的数字，第1个getchar()读取换行符，第二个getchar()让程序暂停，等待输入。  
代码中使用了一种新的变量声明。前面的例子中只使用了整数类型的变量(int)，但是本例使用了浮点数类型(float)的变量，以便处理更大范围的数据。float类型可以存储带小数的数字。  
为了打印新类型的变量，在printf()中使用%f来处理浮点值。%.2f中的.2用于精确控制输出，指定输出的浮点数只显示小数点后两位。  
scanf()函数用于读取键盘的输入。%f说明scanf()要读取用户从键盘输入的浮点数，&weight告诉scanf()把输入的值赋给名为weight的变量。  
#### 变量与常量数据  
要完成各类任务，程序需要使用数据，即承载信息的数字和字符。有些数据类型在程序使用之前已经预先设定好了，在程序运行过程中没有变化，这些称为常量(constant)。其他数据类型在程序运行期间可能会改变或被赋值，这些称为变量(variable)。在示例程序中，weight是一个变量，14.5833是一个常量。那么1700.0是常量还是变量？在现实生活中，白金的价格不会是常量，但是在程序中，像1700.0这样的价格被视为常量。  
#### 数据类型关键字  
不仅变量和常量不同，不同的数据之间也有差异。一些数据类型表示数据，一些数据类型表示字母。C通过识别一些基础的数据类型来区分和使用这些不同的数据类型。如果数据是常量，编译器一般通过用户书写的形式来识别类型(如，42是整数，42.100是浮点数)。但是，对变量而言，要在声明时指定其类型。C语言的基本类型关键字。K&C给出了7个与类型相关的关键字。C90标准添加了2个关键字，C99标准又添加了三个关键字，如下  
>|最初K&R给出的关键字|C90标准添加的关键字|C99标准添加的关键字|
>|:-----:|:-----:|:-----:|
>|int|signed|_bool|
>|long|void|_complex|
>|short|  |_Imaginary|
>|unsigned|  | |
>|char| | |
>|float| | |
>|double| | |    

在C语言中，用int关键字来表示基本的整数类型 。后3个关键字(long、short和 unsigned)和signed用于提供基本整数类型的变式，例如unsigned  short  int和long long int。char关键字用于指定字母和其他字符(如，#、$、%和*)。另外，char类型可以表示较小 的整数。float、double和long double表示带小数点的数。_Bool类型表示布尔值(true或false)，_complex和_Imaginary分别 表示复数和虚数。  
通过这些关键字创建的类型，按计算机的存储方式可分为两大基本类型；整数类型和浮点数类型。  
位、字节和子是描述计算机数据单元或存储单元的术语。这里主要指存储单元。最小的存储单元是位(bit)，可以存储0或1。虽然1位存储的信息有限，但是计算机中位的数量十分庞大。位是计算机内存的基本构建块。  
字节(byte)是常用的计算机存储单元。对于几乎所有的机器，1字节均为8位。这是字节的标准定义，至少在衡量存储单位时是这样。既然1位可以表示0或1，那么8位字节就有256种可能的0、1组合。通过二进制编码 ，便可表示0~255的整数或一组字符。  
字(word)是设计计算机时给定的自然存储单位。对于8位的微型计算机,一个字长只有8位。从那以后 ，个人计算机字长增至16位、32位，直到目前64位。计算机的字长越大，其数据转移越快，允许的内存访问也更多。  
1. 整数和浮点数  
    对我们而言，整数和浮点数的区别是它们的书写方式不同。而对计算机而言，他们的区别 是存储方式不同。  
2. 整数  
    和数学的概念一样，在C语言中，整数是没有小数部分的数。例如，2、-32和2456都是整数。而3.14、0.22和2.000都不是整数。计算机以二进制数存储整数，例如整数7以二进制写是111.因此，要在8位字节中存储该数字，需要把前五位都设置为0，后三位设置成1。  
3. 浮点数  
    浮点数与数学中实数的概念差不多。2.75、3.16E7、7.00和2e-8都是浮点数。注意，在一个值后面加上一个小数点，该值就成为一个浮点值。所以7是整数，7.00是浮点数。  
    这里关键要理解浮点数和整数的存储方案不同。计算机把浮点数分成小数部分和指数部分来表示，而且分开存储这两部分。7.00和7在数值上相同，但是它们的存储方式不同。在十进制下，可以把7.0写成0.7E1。这里，0.7是小数部分，1是指数部分。如下图：  
    ![浮点数存储格式](../../images/C-Learning/C-浮点数存储格式.png)  
    因为在任何区间内(如[1.0,2.0]内)都存在无穷多个实数，所以计算机的浮点数不能表示区间内所有的值。浮点数通常只是实际值的近似值。例如7.0可能被存储为浮点值6.99999。这是一个精度问题。  
#### C语言基本数据类型  
1. int类型  
    C语言提供了许多整数类型，为什么一种类型不够用？因为C语言让程序员针对不同情况选择不同的类型。特别是，C语言中的整数类型可表示不同的取值范围和正负值。一般情况使用int类型即可，但是为满足特定任务和机器的要求，还可以选择其他类型。  
    int类型是有符号整型，即int类型的值必须是整数，可以是正整数、负整数或零。其取值范围依计算机系统而异。一般而言，存储一个int要占用一个机器字长。ISO C规定int的取值范围最小为-32768~32767。  
    * 声明int变量  
        ``` C  
        int erns;
        int hogs,cows,goats;
        cows = 12;
        ```
    * 初始化变量  
        ``` C  
        int hogs = 21;
        int cows = 32,goats = 14;
        int dogs,cats = 94;/*有效，但是这种格式不好*/
        ```
    * int类型常量  
        上面中出现的整数(21、32、14和94)都是整型常量或整型字面量。C语言把大多数整型常量视为int类型，但是非常大的整数除外。  
    * 打印int值  
        [print1.c](../../c-example/print1.c)  
        可以使用printf()函数打印int类型的值。在print1.c中，第二行输出中，第1个%d对应ten的值，但是由于没有给后两个%d提供任何值，所以打印出的值是内存中的任意值。  
    * 八进制和十六进制  
        通常，C语言都假定整型常量是十进制数。然而，许多程序员很喜欢使用八进制和十六进制数。在C语言中，用特定的前缀表示使用哪种进制。0x或0X前缀表示十六进制值，所以十进制数16表示成十六进制是0x10或0X10。与此类似，0前缀表示8进制。  
    * 显示八进制和十六进制  
        在C程序中，既可以使用也可以显示不同进制的数。不同的进制要使用不同的转换说明。以十进制显示数字，使用%d;以八进制显示数字，使用%o；以十六进制显示数字，使用%x。另外，要显示各进制数的前缀0、0x、0X，必须分别使用%#o、%#x、%#X。  
        [bases.c](../../c-example/bases.c)  
2. 其他整数类型  
    初学C语言时，int类型应该能满足大多数程序的整数类型需求。尽管如此，还应了解一下整型的其他形式。C语言提供了3个附属关键字修饰基本整数类型:short、long和unsigned。主要包含以下几点：  

    * short int类型(简写short)占用的存储空间可能比int类型少，常用于较小数值的场合以节省空间。  
    * long int或long占用的存储空间可能比int多，适用于较大数值的场合。与int类似，long是有符号整型。  
    * long long int或long long(C99标准加入)占用的存储空间可能比long多，该类型至少占用64位。  
    *  unsigned int或unsigned只用于非负数值得场合。这种类型与有符号类型表示的范围不同。  
    
    如果整数超出了相应类型的取值范围会怎样？下面分别将有符号类型和无符号类型的整数设置为比最大值略大。  
    [toobig.c](../../c-example/toobig.c)  
    可以把无符号整数看作是汽车的里程表。当达到它能表示的最大值时，会重新从起始点开始。unsigned int类型的变量j从0开始；而int类型的变量则从-2147483648开始，因为负数在计算机中是用补码进行表示的。  
    打印unsigned int类型的值，使用%u转换说明；打印long类型的值，使用%ld转换说明。如果系统中int和long的大小相同，使用%d就行。但是，这样的程序被移植到其它系统中会无法正常工作。在x和o前面可以使用l前缀，%lx表示十六进制格式打印long类型整数，%lo表示以八进制格式打印long类型整数。注意，虽然C允许使用大写或小写的常量后缀，但是在转换说明中只能用小写。  
    C语言有多种printf()格式。对于short类型，可以使用h前缀。%hd表示以十进制显示short类型的整数，%ho表示以八进制显示short类型的整数。h和l前缀都可以和u一起使用，用于表示无符号类型。例如，%lu表示打印unsigned long类型的值。对于支持long long类型的系统，%lld和%llu分别表示有符号和无符号类型。  
    [print2.c](../../c-example/print2.c)  
    当使用错误的转换说明会得到意想不到的结果。第1行输出，对于无符号变量un，使用%d会生成负值！其原因是，无符号值3000000000和有符号值-129496296在系统内存中的内部表示完全相同。因此，如果告诉printf()该数是无符号数，它打印一个值；如果告诉它该数是有符号数，它将打印另一个值。在待打印的值大于有符号值得最大值时，会发生这种情况。对于较小的正数(如96),有符号和无符号类型的存储、显示都相同。  
    第二行输出，对于short类型的变量end，在printf()中无论指定以short类型(%hd)还是int类型(%d)打印，打印出来的值都相同。这是因为在给函数传递参数时，C编译器把short类型的值自动转换成int类型的值。因为int类型被认为是计算机处理整数类型时最高效的类型，使用h修饰符可以显示较大整数被截断成short类型值得情况。第三行就是这种情况，65537用16进制表示就是00010001,%hd表示，printf()只会查看后16位，所以显示的值是1。最后一行类似。
3. 使用字符char类型  
    char类型用于存储字符(如：字母或标点符号)，但是从技术层面看，char是整数类型。因为char类型实际上存储的是整数而不是字符。计算机使用数字编码来处理字符，即用特定的整数表示特定的字符。美国最常用的编码是ASCII编码，本书也使用此编码。如ASCII码中，整数65代表大写字母A。因此，存储字母A实际上存储的是整数65。另外，其他国家的计算机系统可能使用完全不同的编码。  
    标准ASCII码的范围是0~127，只需7位二进制数即可表示。通常，char类型被定义为8位的存储单元，因此容纳标准ASCII码绰绰有余。一般而言，C语言会保证char类型足够大，以存储系统的基本字符集。  
    许多字符集都超过了127，甚至多于255。商用的统一码(Unicode)创建了一个能表示世界范围内多种字符集的系统，目前包含的字符已超过110000个。C语言把1字节定义为char类型占用的位数，因此无论是16位还是32位系统，都可以使用char类型。  
    * 声明char类型变量  
        char类型变量的声明方式与其他类型变量的声明方式相同。如：  
        ``` C  
        char response;
        char itable,latan;
        ```
    * 字符常量和初始化  
        如果要把一个字符常量初始化为字母A，不必背下ASCII码，用计算机语言很容易做到。通过以下初始化把字母A赋给grade即可：  
        ``` C  
        char grade = 'A';
        ```  
        在C语言中，用单引号括起来的单个字符被称为字符常量(character constant)。编译器一发现'A'，就会将其转换成相应的代码值。单引号必不可少。一些错误例子如下：  
        ``` C  
        char broiled;
        broiled = 'T';  /* 为其赋值，正确 */  
        broiled = T;  /* 错误！此时T是一个变量 */  
        broiled = "T"; /* 错误！此时"T"是一个字符串 */  
        ```  
        如上所示，如果省略单引号，编译器认为T是一个变量名；如果把T用双引号括起来，编译器则认为"T"是一个字符串。  
        实际上字符是以数值形式存储的，所以也可使用数字代码来赋值：char grade = 65;，虽然65是int类型，但是它在char类型能表示的范围内，所以将其赋值给grade没问题。由于65是字母A对应的ASCII码，因此本例是把A赋给grade。注意，能这样做的前提是系统使用ASCII码。其实，用'A'代替65才是较为妥当的做法，这样在任何系统中都不会出问题。因此，最好使用字符常量，而不是数字代码值。  
        奇怪的是，C语言将字符常量视为int类型而非char类型。例如，在int为32位、char为8位的ASCII系统中，char grade = 'B';，本来'B'对应的数值66存储在32位的存储单元中，现在却可以存储在8位的存储单元中。利用字符常量的这种特性，可以定义一个字符常量'FATE'，即把4个独立的8位ASCII码存储在一个32位存储单元中。如果把这样的字符常量赋给char类型变量grade，只有最后8位有效。因此，grade的值是'E'。
    * 非打印字符  
        单引号只适用于字符、数字和标点符号，浏览ASCII表会发现，有些ASCII字符打印不出来。例如，一些代表行为的字符(如，退格、换行、终端响铃或蜂鸣)。C语言提供了三种方法表示这些字符。  
        1. 使用ASCII码  
        2. 使用特殊的符号序列表示一些特殊的字符。这些符号序列叫做转义序列(escape sequence)
    
        >|转义序列|含义|  
        >|:--:|:------:|  
        >|\a|报警|
        >|\b|退格|  
        >|\f|换页|  
        >|\n|换行|  
        >|\r|回车|  
        >|\t|水平制表符|  
        >|\v|垂直制表符|  
        >|\\|反斜杠(\)|
        >|\'|单引号|  
        >|\"|双引号|
        >|\?|问号|  
        >|\0oo|八进制值|  
        >|\xhh|十六进制值|  

        现在，我们来仔细分析一下转义序列。使用C90新增的警报字符(\a)是否能产生听到或看到的警报，取决于计算机的硬件，蜂鸣是最常见的警报。C标准规定警报字符不得改变活跃位置。标准中的活跃位置指的是显示设备中下一个字符将出现的位置。简而言之，平时常说的屏幕光标位置就是活跃位置。  
    * 打印字符  
        printf()函数用%c指明待打印的字符。前面介绍过，一个字符变量实际上被储存为1字节的整数值。因此，如果用%d转换说明打印char类型变量的值，打印的是一个整数。而%c转换说明告诉printf()打印该整数值对应的字符。  
        [charcode.c](../../c-example/charcode.c)  
    * 有符号还是无符号  
        有些C编译器把char实现为有符号类型，这意味着char可表示的范围是-128~127。而有些C编译器把char实现为无符号类型，那么char可表示的范围是0~255。根据C90标准，C语言允许在关键字char前面使用signed或unsigned。这样，无论编译器默认char是什么类型，signed char表示有符号类型，而unsigned char表示无符号类型。这在用char类型处理小整数时很有用。如果只用char处理字符，那么char前面无需使用任何修饰符。  
4. _Bool类型  
    C99标准加了_Bool类型，用于表示布尔值，即逻辑值true和false。因为C语言用值1表示true，值0表示false，所以_Bool类型实际上也是一种整数类型。但原则上它仅占用1位存储空间，因为对0和1而言，1位的存储空间足够了。  
5. 可移植类型:stdint.h和inttypes.h  
    C语言提供了许多有用的整数类型。但是，某些类型名在不同系统中的功能不一样。C99新增了两个头文件stdint.h和inttypes.h，以确保C语言的类型在各系统中的功能相同。  
    [altnames.c](../../c-example/altnames.c)  
6. float、double和long double  
    各种整数类型对大多数软件开发项目而言够用了。然而，面向金融和数学的程序经常使用浮点数。C语言中的浮点类型有float、double和long double类型。它们与FORTRAN和Pascal中的real类型一致。前面提到过，浮点类型能表示包括小数在内更大范围的数。浮点数的表示类似于科学记数法(即用小数乘以10的幂来表示数字)。该记数系统常用于表示非常大或非常小的数。  
    C语言规定，float类型必须至少能表示6位有效数字，且取值范围至少是1e-37~1e37。前一项规定指float类型必须至少精确表示小数点后的6位有效数字，如33.333333。后一项规定用于方便地表示诸如太阳质量等数字。通常，系统存储一个浮点数要占用32位。其中8位用于表示指数的值和符号，剩下24位用于表示非指数部分(也叫作尾数或有效数)及其符号。  
    C语言提供的另一种浮点类型是double。double类型和float类型的最小取值范围相同，但至少必须能表示10位有效数字。一般情况下，double占用64位而不是32位。一些系统将多出的32位全部用来表示非指数部分，这不仅增加了有效数字的位数(即提高了精度),而且还减少了舍入误差。另一些系统把其中的一些位分配给指数部分，以容纳更大的指数，从而增加了可表示数的范围。无论哪种方法，double类型的值至少有13位有效数字，超过了标准的最低位数规定。  
    C语言的第3种浮点类型是long double，以满足比double类型更高的精度要求。不过，C只保证long double类型至少与double类型的精度相同。  
    * 声明浮点型变量  
        浮点型变量的声明和初始化方式与整形变量相同。
        ``` c  
        float noah, jonah;
        double trouble;
        float planck = 6.63e-34;
        long double gnp;
        ```
    * 浮点型常量  
        在代码中，可以用多种形式书写浮点型常量。浮点型常量的基本形式是：有符号的数字，后面紧跟e或E，最后是一个有符号数表示10的指数。-1.56E+12、2.87e-3。  
        正号可以省略。可以没有小数点如(2E5)或指数部分(19.28)，但是不能同时省略两者。可以省略小数部分(3.E16)或整数部分(.45E-6)，但是不能同时省略两者。  
        ***不要在浮点型常量中间加空格：1.56 E+12(错误！)***  
        默认情况下，编译器假定浮点型常量是double类型的精度。例如假设some是float类型的常量，编写如下语句：some=4.0*2.0;通常，4.0和2.0被存储为64位的double类型，使用双精度进行乘法运算，然后将乘积截断成float类型的宽度。这样做虽然计算精度更高，但是会减慢程序的运行速度。  
        在浮点数后面加上f或F后缀可覆盖默认设置，编译器会将浮点型常量看作float类型，如2.3f和9.11E9F。使用l或L后缀使得数字成为long double类型，如54.3l和4.32L。没有后缀的浮点型常量是double类型。  
        C99标准添加了一种新的浮点型常量格式————用十六进制表示浮点型常量，即在十六进制数前加上十六进制前缀(0x或0X),用p和P分别代替e和E，用2的幂代替10的幂(即，p计数法)。如：0xa.1fp10(10+1/16+15/256)*1024。  
    * 打印浮点值  
        printf()函数使用%f转换说明打印十进制记数法的float和double类型浮点数，用%e打印指数记数法的浮点数。如果系统支持十六进制格式的浮点数，，可用a和A分别代替e和E。打印long double类型要使用%Lf、%Le或%La转换说明。给那些未在函数原型中显示说明参数类型的函数传递参数时，C编译器会把float类型的值自动转换成double类型。  
        [showf_pt.c](../../c-example/showf_pt.c)
    * 浮点值的上溢和下溢  
        假设系统的最大float类型值是3.4E38，编写如下代码：  
        ``` C  
        float toobig = 3.4E38* 100.0f;
        printf("%e\n",toobig);
        ```  
        会发生什么？这是一个上溢(overflow)的示例。当计算导致数字过大，超过当前类型能表达的范围时，就会发生上溢。这种行为在过去是未定义的，不过现在C语言规定，在这种情况下会给toobig赋一个表示无穷大ade特定值，而且printf()显示该值为inf或infinity。  
        当除以一个很小的数时，情况更为复杂。回忆一下，float类型的数以指数和尾数部分来存储。存在这样一个数，它的指数部分是最小值，即由全部可用位表示的最小为尾数值。该数字是float类型给用全部精度表示的最小数字。现在把它除以2。通常，这个操作会减小指数部分，但是假设的情况中，指数已经是最小值了。所以计算机只好把尾数部分的位向右移，空出第1个二进制位，并丢弃最后一个二进制数。以十进制为例，把一个有4位有效数字的数(如，0.1234E-10)除以10，得到的结果是0.0123E-10。虽然得到了结果，但是在计算过程中却损失了原末尾有效位上的数字。这种情况叫做下溢(underflow)。C语言把损失了类型全精度的浮点值称为低于正常的(subnormal)浮点值。因此，把最小的正浮点数除以2将得到一个低于正常的值。如果除以一个非常大的值，会导致所有的位都为0。现在，C库已提供了用于检查计算是否会产生低于正常值的函数。  
        还有另一个特殊的浮点值NaN(not a number的缩写)。例如，给asin()函数传递一个值，该函数将返回一个角度，该角度的正弦就是传入函数的值。但是正弦值不能大于1，因此，如果传入的参数大于1，该函数的行为是未定义的。在这种情况下，该函数将返回NaN值，printf()函数可将其显示为nan、NaN或其他类似的内容。  
        **浮点数舍入错误**  
        给定一个数，加上1，再减去原来给定的数，结果是多少？你一定认为是1。但是，下面的浮点运算给出了不同的答案：  
        [floaterr.c](../../c-example/floaterr.c)  
        得出这些奇怪答案的原因是，计算机缺少足够的小数位来完成正确的运算。2.0e20是2后面又20个0。如果把该数加1，那么发生变化的是第21位。要正确运算，程序至少要存储21位有效数字。而float类型的数字通常只能存储按指数比例缩小或放大的6或7位有效数字。在这种情况下，计算结果一定是错误的。  
7. 复数和虚数类型  
    许多科学和工程计算都要用到复数和虚数。C99标准支持复数类型和虚数类型，但是有所保留。一些独立实现，如嵌入式处理器的实现，就不需要使用复数和虚数。一般而言，虚数类型都是可选项。C11标准把整个复数软件包都作为可选项。  
    简而言之，C语言有3种复数类型:float_Complex、double_Complex和long double_Complex。例如，float_Complex类型的变量应包含两个float类型的值，分别表示复数的实部和虚部。类似地，C语言的3种虚数类型是float_Imaginary、double_Imaginary和long double_Imaginary。  
    如果包含complex.h头文件，便可用complex代替_Complex,可用imaginary代替_Imaginary，还可以用I代替-1的平方根。  
8. 其他类型  
    现在已经介绍完C语言的所有基本数据类型。有些人认为这些类型实在是太多了，但有些人觉得还不够用。注意，虽然C语言没有字符串类型，但也能很好地处理字符串。  
    C语言还有一些从基本类型衍生的其他类型，包括数组、指针、结构和联合。尽管后面章节中会详细介绍这些类型，但是本章的程序实例中已经用到了指针(指针pointer指向变量或其他数据对象位置)。  
    基本数据类型，关键字有11个:int、long、short、unsigned、char、float、double、signed、—_Bool、_Complex和_Imaginary。  
    * 有符号整型  
        有符号整型可用于表示正整数和负整数  
        int————系统给定的基本整数类型。C语言规定int类型不小于16位。  
        short————最大的short类型整数小于或等于最大的int类型整数。C语言规定short类型至少占16位。  
        long————该类型可表示的整数大于或等于最大的int类型整数。C语言规定long类型至少占32位。  
        long long————该类型可表示的整数大于或等于最大的long类型整数。long long类型至少占64位。  
        一般而言，long类型占用的内存比short类型大，int类型的宽度要么和long类型相同，要么和short类型相同。
    * 无符号整型  
        无符号整型只能用于表示零和正整数，因此无符号整型可表示的正整数比有符号整型的大。在整型类型前加上关键字unsigned表明该类型是无符号整型，单独的unsigned相当于unsigned int。  
    * 字符类型  
        可打印出来的符号(如A、&和+)都是字符。根据定义，char类型表示一个字符要占用1字节内存。出于历史原因，1字节通常是8位，但是如果要表示基本字符集，也可以是16位或更大。  
        char————字符类型的关键字。有些编译器使用有符号的char，而有些则使用无符号的char。在需要时，可在char前面加上关键字signed或unsigned来指明具体使用哪一种类型。  
    * 布尔类型  
        布尔值表示true和false。C语言用1表示true，0表示false。  
        _Bool————布尔类型的关键字。布尔类型是无符号int类型，所占用的空间只要能存储0或1即可。  
    * 实浮点类型  
        实浮点类型可表示正浮点数和负浮点数。  
        float————系统的基本浮点类型，可精确表示至少6位有效数字。  
        double————存储浮点数的范围更大，能表示比float类型更多的有效数字(至少10位，通常会更多)和更大的指数。  
        long long double————存储浮点数的范围比double更大，能表示比double更多的有效数字和更大的指数。  
    * 复数和虚数浮点数  
9. 类型大小  
    如何知道当前系统的指定类型的大小是多少？运行typesize.c  
    [typesize.c](../../c-example/typesize.c)  
    sizeof是C语言的内置运算符，以字节为单位给出指定类型的大小。C99和C11提供%zd转换说明匹配sizeof的返回类型size_t。 
#### 使用数据类型  
编写程序时，应注意合理选择所需的变量及其类型。通常，用int或float类型表示数字，char类型表示字符。在使用变量之前必须先声明，并选择有意义的变量名。初始化变量应使用与变量类型匹配的常数类型。  
把一个类型的数值初始化给不同类型的变量时，编译器会把值转换成与变量匹配的类型，这将导致部分数据丢失。例如：  
``` C  
int cost=12.99;/* 用double类型的值初始化int类型的变量 */
float pi = 3.1415926536;/* 用double类型的值初始化float类型的变量 */
```  
第1个声明，cost的值是12。C编译器把浮点数转换成整数时，会直接丢弃小数部分，而不进行四舍五入。第2个声明会损失一些精度，因为C只保证了float类型前6位的精度。编译器对这样的初始化可能给出警告。  
#### 参数和陷阱  
printf()函数的用法。读者应该还记得，传递给函数的信息被称为参数。例如printf("Hello")函数调用有一个参数"Hello"。双引号中的字符序列被称为字符串(string),无论双引号中包含多少个字符和标点符号，一个字符串就是一个参数。  
与此类似，scanf("%d",&weight)函数调用有两个参数:"%d"和&weight。C语言用逗号分隔函数中的参数。printf()和scanf()函数与一般函数不同，它们的参数个数是可变的。程序要知道函数的参数个数才能正常工作。printf()和scanf()函数用第1个参数表明后续有多少个参数，即第1个字符串中的转换说明与后面的参数一一对应。  
程序员要负责确保转换说明的数量、类型与后面参数的数量、类型相匹配。现在，C语言通过函数原型机制检查函数调用时参数的个数和类型是否正确。但是，该机制对printf()和scanf()不起作用，因为这两个函数的参数个数可变。如果参数在匹配上有问题，会出现什么情况？如下：  
[badcount.c](../../c-example/badcount.c)  
所有编译器都能顺利编译并运行该程序，但其中大部分会给出警告。的确，有些编译器会捕获到这类问题，然而C标准对此未作要求。因此，计算机在运行时可能不会捕获这类错误。  
#### 转义序列示例  
再来看一个程序示例，该程序使用了一些特殊的转义序列。程序清单3.10演示了退格(\b)、水平制表符(\t)和回车(\t)的工作方式。  
[escape.c](../../c-example/escape.c)  
1. 程序运行情况  
    假设在系统中运行的转义序列行为与本章描述的行为一致，下面来分析这个程序。  
    第1条printf()语句发出一声警报，然后打印下面的内容:  
    Enter your desired monthly salary:  
    因为printf()中的字符串末尾没有\n,所以光标停留在冒号后面。  
    第2条printf()语句在光标处接着打印，屏幕上显示的内容是:  
    Enter your desired monthly salary: $_______  
    冒号和美元符号之间有一个空格，这是因为第2条printf()语句中的字符串以一个空格开始。7个退格字符使得光标左移7个位置，即把光标移至7个下划线字符的前面，紧跟在美元符号后面。通常，退格不会擦除退回所经过的字符，但有些实现是擦除的，这和本例不同。  
    假设键入的数据是4000.00(并按下Enter键),屏幕显示的内容应该是：  
    Enter your desired monthly salary:$4000.00
    键入的字符替换了下划线字符。按下Enter键后，光标移至下一行的起始处。  
    第3条printf()语句中的字符串以\n\t开始。换行字符使光标移至下一行起始处。水平制表符使光标移至该行的下一个制表点，一般是第9列。然后打印字符串中的其他内容。执行完该语句后，此时屏幕显示的内容应该是:  
    Enter your desired monthly salary: $4000.00  
    &4000.00 a month is $48000.00 a year.  
    因为这条printf()语句中没有使用换行字符，所以光标停留在最后的点号后面。  
    第4条printf()语句以\r开始。这使得光标回到当前行的起始处。然后打印Gee！，接着光标移至下一行的起始处。屏幕最后显示的内容应该是：  
    Enter your desired monthly salary: $4000.00  
    Gee! $4000.00 a month is $48000.00 a year.  
2. 刷新输出  
    printf()何时把输出发送到屏幕上？最初，printf()语句把输出发送到一个叫做缓冲区(buffer)的中间存储区域，然后缓冲区中的内容再不断被发送到屏幕上。C标准明确规定了何时把缓冲区中的内容发送到屏幕：当缓冲区满、遇到换行字符或需要输入的时候(从缓冲区把数据发送到屏幕或文件被称为刷新缓冲区)。例如，前两个printf()语句既没有填满缓冲区，也没有换行符，但是下一条scanf()语句要求用户输入，这迫使printf()的输出被发送到屏幕上。  
    旧式编译器遇到scanf()也不会强行刷新缓冲区，程序会停在那里不显示任何提示内容，等待用户输入数据。在这种情况下，可以使用换行字符刷新缓冲区。  
    无论接下来的输入是否能刷新缓冲区，代码都会正常运行。浙江导致光标移至下一行起始处，用户无法在提示内容同一行输入数据。还有一种刷新缓冲区的方法是使用fflush()函数。  
### 4. 字符串和格式化输入/输出  
本章介绍一下内容：函数：strlen()、关键字：const、字符串、如何创建存储字符串、如何使用strlen()函数获取字符串的长度、用C预处理器指令#define和ANSIC的const修饰符创建符号常量。  
#### 前导程序  
[talkback.c](../../c-example/talkback.c)  
该程序包含以下新特性。  
用数组array存储字符串。在改程序中，用户输入的名被存储在数组中，该数组占用内存中40个连续的字节，每个字节存储一个字符值。  
使用%s转换说明来处理字符串的输入和输出。注意，在scanf()中，那么没有&前缀，而weight有。  
用C预处理器把字符常量DENSITY定义为62.4。  
用C函数strlen()获取字符串的长度。  
#### 字符串简介  
字符串是一个或多个字符的序列，如下所示:  
"Zing went the strings of my heart!"  
双引号不是字符串的一部分。双引号仅告知编译器它括起来的是字符串，正如单引号用于标识单个字符一样。  
1. char类型数组和null字符  
    C语言没有专门用于存储字符串的变量类型，字符串都被存储在char类型的数组中。数组由连续的存储单元组成，字符串中的字符被存储在相邻的存储单元中，每个单元存储一个字符。  
    ![数组中的字符串](../../images/C-Learning/数组中的字符串.png)  
    图中数组末尾位置的字符\0。这是空字符(null character),C语言用它标记字符串的结束。空字符不是数字0，它是非打印字符，其ASCII码值是0。C中的字符串一定以空字符结束，这意味着数组的容量必须至少比待存储字符串中的字符数多1。因此，程序talkback中有40个存储单元的字符串，只能存储39个字符，剩下一个字节留给空字符。  
    那么，什么是数组？可以把数组看作是一行连续的多个存储单元。用更正式的说法是，数组是同类型数据元素的有序序列。程序talkback通过char name[40]声明创建了一个包含40个存储单元的数组，每个单元存储一个char类型的值。  
    name后面的方括号表明这是一个数组，方括号中的40表明该数组中的元素数量。char表明每个元素的类型。  
2. 使用字符串  
    [praise1.c](../../c-example/praise1.c)  
    你不用亲自把空字符放入字符串末尾，scanf()在读取输入时就已完成这项工作。也不用在字符串常量PRAISE末尾添加空字符。  
    注意，**scanf()只读取Angela Plains中的Angela**,它在遇到第一个空白时就不再读取输入。因此，scanf()在读到Angela和Plains之间的空格时就停止了。一般而言，根据%s转换说明，scanf只会读取字符串中的一个单词，而不是一整句。  
3. strlen()函数  
    上一章提到了sizeof运算符，它以字节为单位给出对象的大小。strlen()函数给出字符串中的字符长度。因为1字节存储一个字符，读者可能认为把两种方法应用于字符串得到的结果相同，但事实并非如此。  
    [praise2.c](../../c-example/praise2.c)  
    如果使用ANSI C之前的编译器，必须移除这一行:  
    #include <string.h>  
    sizeof运算符报告，name数组有40个存储单元。但是，只有前11个单元用来存储Serendipity，所以strlen()得出的结果是11。name数组的第12个单元存储空字符，strlen()并未将其计入。  
    对于PRAISE，用strlen()得出的也是字符串中的字符数。然而，sizeof运算符给出的数更大，因为它把字符串末尾不可见的空字符也计算在内。该程序并未明确告诉计算机要给字符串预留多少空间，所以它必须计算双引号内的字符数。  
    另外，还要注意一点：上一章的sizeof使用了圆括号，但本例没有。圆括号的使用时机取决于运算对象是类型还是特定量，运算对象是类型时，圆括号必不可少，但是对于特定量，可有可无。也就是说，对于类型，应写成sizeof(char)或sizeof(float);对于特定量，可写成sizeof name或sizeof 6.28。还是建议所有情况下都使用圆括号。  
#### 常量和C预处理器  
有时，在程序中要使用常量。例如，这样计算圆的周长:  
circumference = 3.14159 * diameter;  
这里，常量3.14159代表著名的常量pi(π)。在该例中，输入实际值便可使用这个常量。然而，这种情况使用符号常量(symbolic constant)会更好。也就是说，使用下面的语句，计算机稍后会用实际值完成替换:  
circumference = pi * diameter  
使用常量更好，首先常量名比数字表达的信息更多。然后，假设程序中的多处使用一个常量，有时需要改变它的值。如果程序使用符号常量，则只需要更改符号常量的定义，不用在程序中查找使用常量的地方，然后逐一修改。  
如何创建符号常量？方法之一是声明一个变量，然后将该变量设置为所需的常量。可以这样写:  
``` C  
float taxrate;
taxrate = 0.015;  
```    
这样做提供了一个符号名，但是taxrate是一个变量，程序可能会无意间改变它的值。C语言还提供了一个更好的方案————C预处理器。第2章中介绍了预处理器如何使用#include包含其他文件的信息。预处理器也可用来定义常量。只需在程序顶部添加下面一行:  
#define TAXRATE 0.015  
编译程序时，程序中所有的TAXRATE都会被替换成0.015。这一过程被称为编译时替换。在运行程序时，程序中所有的替换均已完成。通常，这样定义的常量也称为明示常量。  
[pizza.c](../../c-example/pizza.c)  
printf()语句中的%1.2f表明，结果被四舍五入为两位小数输出。  
#define指令还可定义字符和字符串常量。前者使用单引号，后者使用双引号。  
1. const限定符  
    C90标准新增了const关键字，用于限定一个变量为只读。其声明如下:
    const int MONTHS=12；  
    这使得MONTHS成为一个只读值。也就是说，可以在计算中使用MONTHS，可以打印MONTHS，但是不能更改MONTHS值。const用起来比#define更灵活。  
2. 明示常量  
    C头文件limits.h和float.h分别提供了与整数类型和浮点类型大小限制相关的详细信息。每个头文件都定义了一系列供实现使用的明示常量。例如，limits.h头文件包含以下类似的代码:  
    ``` C  
    #define INT_MAX +32767
    #define INT_MIN -32768  
    ```  
    这些明示常量代表int类型可表示的最大值和最小值。如果系统使用32位的int，该头文件会为这些明示常量提供不同的值。如果在程序中包含limits.h头文件，就可编写下面的代码：  
    ``` C  
    printf("Maximum int value on this system = %d\n",INT_MAX);
    ```  
    如果系统使用4字节的int，limits.h头文件会提供符合4字节int的INT_MAX和INT_MIN。  
    类似地，float.h头文件中也定义一些明示常量，如FLT_DIG和DBL_DIG，分别表示float类型和double类型的有效数字位数。如下程序演示了如何使用float.h和limits.h中的数据。  
    [defines.c](../../c-example/defines.c)  
#### printf()和scanf()  
printf()函数和scanf()函数能让用户可以与程序交流，它们是输入/输出函数，或简称I/O函数。它们不仅是C语言中的I/O函数，而且是最多才多艺的函数。过去，这些函数和C库的一些其他函数一样，并不是C语言定义的一部分。最初，C把输入/输出的实现留给了编译器的作者，这样可以针对特殊的机器更好地匹配输入/输出。后来，考虑到兼容性的问题，各编译器都提供不同版本的printf()和scanf()。尽管如此，各版本之间偶尔有一些差异。  
1. printf()函数  
    请求printf()函数打印数据的指令要与待打印数据的类型相匹配。例如，打印整数时使用%d，打印字符时使用%c。这些符号被称为转换说明(conversion specification)，它们指定了如何把数据转换成可显示的形式。  
2. 使用printf()  
    [printout.c](../../c-example/printout.c)  
    由于printf()函数使用%符号来标识转换说明，因此打印%符号就成了个问题。如果单独使用一个%符号，编译器会认为漏掉了一个转换字符。解决方法很简单，使用两个%符号就行了。  
3. printf()的转换说明修饰符  
    在%和转换字符之间插入修饰符可修饰基本的转换说明。表4.4和表4.5列出可作为修饰符的合法字符。涮锅要插入多个字符，其书写顺序应该与表4.4中列出的顺序相同。不是所有的组合都可行。  
    >***表4.4***  
    >
    >|修饰符|含义  |  
    >|---:|:---|
    >|标记|表4.5描述了5种标记(-、+、空格、#和0),可以不使用标记或使用多个标记，如:"%-10d"|
    >|数字|最小字段宽度,如:"%4d"|
    >|.数字|精度，如"%5.2f"|
    >|t|和整型转换说明一起使用，表示ptrdiff_t类型的值。ptrdiff_t是两个指针差值的类型，如:"%td"|
    >|z|和整数转换说明一起使用，表示size_t类型的值。size_t是sizeof返回的类型，如:"%zd"|  
    >***表4.5***  
    >
    >|标记符|含义|
    >|---:|:---|
    >|-|待打印项左对齐，即，从字段的左侧开始打印该项，如"%-20s"|
    >|+|有符号值若为正，则在值前面显示加号；若为负，则在值前面显示减号,如"+6.2f"|
    >|空格|有符号值若为正，则在值前面显示前导空格(不显示任何符号)|
    >|#|把结果转换为另一种形式，如果是%o格式，则以0开始;如果是%x或%X格式，则以0x或0X开始；如："%#o"、"%#8.0f"、"%+#10.3e"|
    >|0|对于数值格式，用前导0代替空格填充字段宽度。对于整数格式，如果出现-标记或指定精度，则忽略该标记|  
    - 使用修饰符和标记的示例  
        字段宽度在打印整数时的效果。  
        [width.c](../../c-example/width.c)  
        浮点型格式的效果。  
        [floats.c](../../c-example/floats.c)  
        标记的效果。  
        [flags.c](../../c-example/flags.c)  
        字符串格式的效果。  
        [stringf.c](../../c-example/stringf.c)  
4. 转换说明的意义  
    下面深入探讨一下转换说明的意义。转换说明把以二进制格式存储在计算机中的值转换成一系列字符以便于显示。例如，数字76在计算机内部的存储格式是二进制数01001100。%d转换说明将其转换成字符7和6，并显示为76;%x转换说明把相同的值(01001100)转换成十六进制记数法4c；%c转换说明把01001100转换成字符L。  
    - 转换不匹配  
        前面强调过，转换说明应该与待打印值的类型相匹配。通常都有多种选择。下列程序    
        [intconv.c](../../c-example/intconv.c)  
        混淆整型和浮点型，结果更奇怪。如下程序    
        [floatcnv.c](../../c-example/floatcnv.c)  
        第1行说明了，float类型的值作为printf()参数时会被转换成double类型。在本系统中，float是4字节，但是为了printf()能正确地显示该值，n1被扩成8字节。  
        第3行输出显示，如果printf()语句有其他不匹配的地方，即使用对了 转换说明也会生成虚假的结果。用%ld转换说明打印浮点数会失败，但是在这里，用%ld打印long类型的数竟然也失败了！问题出在C如何把信息传递给函数。具体情况因编译器实现而异。“参数传递”框中针对一个有代表性的系统进行了讨论。  
        ***参数传递***  
        分析参数传递的原理，函数调用如下:   
        printf("%ld %ld %ld %ld\n",n1,n2,n3,n4);  
        该调用告诉计算机把变量n1、n2、n3、n4的值传递给程序。这是一种常见的参数传递方式。程序把传入的值放入被称为栈(stack)的内存区域。计算机根据变量类型(不是根据转换说明)把这些值放入栈中。因此，n1被存储在栈中，占8字节(float被转换成double类型)。同样，n2也在栈中占8字节，而n3和n4在栈中分别占4字节。然后，控制转到printf()函数。该函数根据转换说明(不是根据变量类型)从栈中读取值。%ld转换说明表明printf()应该读取4字节，所以printf()读取栈中的前4字节作为第1个值。这是n1的前半部分，将被解释成一个long类型的整数。根据下一个%ld转换说明，printf()再读取4字节 ，这是n1的后半部分，将 被解释成第2个long类型的整数。类似地，根据第3个和第4个%ld，printf()读取n2的前半部分和后半部分，并解释成两个long类型的整数。因此对于n3和n4，虽然用对了转换说明，但printf()还是读错了字节。如下图所示  
        ![传递参数](../../images/C-Learning/传递参数.png)  
    - printf()的返回值  
        大部分C函数都有一个返回值，这是函数计算返回给主调程序(calling program)的值。例如，C库包含一个sqrt()函数，接受一个数作为参数，并返回该数的平方根。可以把返回值赋给变量，也可以用于计算，还可以作为参数传递。总之，可以把返回值像其他值一样使用。printf()函数也有一个返回值，它返回打印字符的个数。如果有输出错误，printf()则返回一个负值(printf()的旧版本会返回不同的值)。程序prntval.c展示了如何确定函数的返回值  
        [prntval.c](../../c-example/prntval.c)  
    - 打印较长的字符串  
        有时，printf()语句太长，在屏幕上不方便阅读。如果空白(空格、制表符、换行符)仅用于分隔不同的部分，C编译器会忽略它们。因此，一条语句可以写成多行，只需在不同部分之间输入空白即可。例如prntval.c中的语句:  
        ``` C  
        printf("The printf() function printed %d characters.\n",
        rv);  
        ```  
        该语句在逗号和rv之间断行。为了让读者知道该行未完，示例缩进了rv。C编译器忽略多余的空白。  
        但是，不能在双引号括起来的字符串中间断行，因为字符串中有非法字符。在字符串中，可以使用\n来表示换行字符，但是不能通过按下Enter键产生实际的换行符。给字符串断行有三种方法，如下:  
        [longstrg.c](../../c-example/longstrg.c)  
        + 方法1:使用多个printf()语句。因为第1个字符串没有以\n字符结束，所以第2个字符串紧跟第1个字符串末尾输出。  
        + 方法2:用反斜杠(\)和Enter键组合来断行。这使得光标移至下一行，而且字符串不会包含换行符。其效果是在下一行继续输出。但是，下一行代码必须和程序清单中的代码一样从最左边开始。如果缩进该行，比如缩进5个空格，那么这五个空格就会成为字符串的一部分。  
        + 方法3:ANSI C引入的字符串连接。在两个用双引号括起来的字符串之间用空白隔开，C编译器会把多个字符串看作是一个字符串。因此，以下3种形式是等效的:  
        ``` C  
        printf("Hello,young lovers,wherever you are.");
        printf("Hello,young"    "lovers"",wherever you are.);
        printf("Hello,young lovers"
        ",wherever you are.");
        ```  
5. 使用scanf()  
    C库包含了多个输入函数，scanf()是最通用的一个，因为它可以读取不同格式的数据。当然，从键盘输入的都是文本，因为键盘只能生成文本字符:字母、数字和标点符号。如果要输入整数2014,就要键入字符2、0、1、4。如果要将其存储为数值而不是字符串，程序就必须把字符依次转换成数值，这就是scanf()要做的。scanf()把输入的字符串转换成整数、浮点数、字符或字符串，而printf()正好与它相反，把整数、浮点数、字符和字符串转换成显示在屏幕上的文本。  
    scanf()和printf()类似，也使用格式字符串和参数列表。scanf()中的格式字符串表明字符输入流的目标数据类型。两个函数主要的区别在参数列表中。printf()函数是用变量、常数和表达式，而scanf(())函数使用指向变量的指针。  
    [input.c](../../c-example/input.c)  
    sacnf()函数使用空白(换行符、制表符和空格)把输入分成多个字段。在依次把转换说明和字段匹配时跳过空白。  
    唯一例外的是%c转换说明。根据%c，scanf()会读取没个字符，包括空白。