---
title: "C语言基础"
date: 2020-08-16T13:13:46+08:00
Description: "主要是看C primer plus总结"
Tags: ["C"]
Categories: ["编程语言"]
DisableComments: false
---

### 1. 初识C语言
#### C语言的7个步骤  
1. 定义程序的目标  
    思考你的程序需要哪些信息，要进行那些计算和控制，以及程序要报告什么信息。  
2. 设计程序  
    主要的一点就是程序中的数据如何表示，以及用什么方法来处理数据。
3. 编写代码  
    把设计好的思路用C语言实现，注意要添加正确的文字注释。  
4. 编译  
    编译取决于环境，编译器是把源代码转换成可执行代码的程序。可执行代码是用机器语言表示的代码，由数字码表示的指令组成。通常C编译器还将源代码和C库的代码合并成最终的程序(准确来说是用链接器来链接库函数)。  
5. 运行程序  
    在常见环境中运行程序要输入可执行文件的文件名，其他环境核能要运行命令。
6. 测试和调试程序  
    发现程序中的错误(bug),查找并修复程序错误的过程叫调试。  
7. 维护和修改代码  
    主要是程序有错或需要扩展程序用途的时候，就需要修改程序。  
#### 编程机制  
&emsp;C编程的基本策略是，用程序把源代码文件转换为可执行文件。典型的C实现通过编译和链接两个步骤来完成。编译器把源代码转换成中间代码，链接器把中间代码和其他代码合并，生成可执行文件。可以独立编译单独的模块，稍后再用链接器合并已编译的模块，这样在只更改了某个模块时，不必重新编译其他模块。  
&emsp;中间文件有多种形式。最普遍的一种形式是吧源代码转换成机器语言代码，并把结果放在目标代码文件中。但目标文件不能直接运行，并不是一个完整的程序。  
&emsp;目标代码文件缺失启动代码，启动代码充当着程序和操作系统之间的接口。目标文件还缺少库函数，许多函数的目标代码在库文件中。链接器的作用是把你编写的目标代码、系统的标准启动代码和库代码三部分合成一个文件，即可执行文件。对于库代码，链接器只会把程序中要用的库函数代码提取出来如下图:
![C-编译器和链接器](../../images/C-Learning/C-编译器和链接器.png)  
#### GNU编译器合集  
&emsp;GNU编译器合集也被称为GCC，其中包含GCC C编译器。可以根据不同的版本选择运行时调用不同C标准  
``` shell
gcc -std=99 inform.c  //调用C99标准
gcc -std=clx inform.c  //接受C11之前的草案标准
gcc -std=cll inform.c  //接受C11标准
```  
### 2. C 语言概述
#### 简单的C程序  
[first.c](../../c-example/first.c)
```C  
#include<stdio.h>

int main(void)
{
    int num;
    num = 1;
    printf("I am a simple");
    printf("computer.\n");
    printf("My favorite number is %d because it is first.\n", num);
    getchar();
    return 0;
}  
```  
1. #include指令和头文件  
&emsp;#include<stdio.h> 这是程序的第一行，相当于把stdio.h中的所有内容都输入该行所在的位置。实际上，这是一种“拷贝-粘贴”的操作。  
&emsp;#include这行代码是一条C预处理指令(preprocessor directive)。通常，在C程序顶部的信息集合被称为头文件，在大多数情况下，头文件包含了编译器创建最终可执行程序要用到的信息。例如，头文件中可以定义一些常量，或者指明函数名及如何使用它们。但是函数的实际代码在一个预编译代码的库文件中。  
2. main()函数  
&emsp; int main(void)  C程序一定从main()函数开始执行(目前不必考虑例外情况)。int是main()函数的返回类型，这表明main()函数返回的值是整数。通常函数名后面的圆括号中包含一些传入函数的信息。该例中没有传递任何信息。因此，圆括号内饰单词void。  
3. 注释  
/\*一个简单的程序\*/  
&emsp;在程序中，被/\* /\*两个符号括起来的部分是程序的注释。写注释能让他人(自己)更容易明白你你所写的程序。C99新增了另一种风格的注释，使用//符号创建注释，仅限于单行。  
4. 花括号、函数体和块  
&emsp;花括号把main()函数括起来。一般而言，所有的C函数都使用花括号标记函数体的开始和结尾。这是规定，不能省略。花括号还可用于把函数中的多条语句合并为一个单元或块。  
5. 声明  
int num；  
&emsp;这行代码叫做声明。声明是C语言最重要的特征之一。声明完成了两件事情，一是在函数中有一个名为num的变量，二是int表明num是一个整数。int是一种数据类型。编译器使用这些信息为num变量在内存中分配存储空间。  
&emsp;int是C语言的一个关键字，表示一种基本的C语言数据类型。关键字是语言定义的单词，不能做其他用途。如用作函数名和变量名。  
&emsp;示例中的num是一个标识符，也就是一个变量、函数或其他实体的名称。因此，声明2把特定标识符与计算机内存中的特定位置联系起来，同时也确定了存储在某位置的信息类型或数据类型。C语言中，所有变量都必须先声明才能使用，这意味着必须列出程序中用到的所有变量名及其类型。
* 数据类型  
> C语言可以处理多种类型的数据，如整数、字符和浮点数。把变量声明为整形或字符类型，计算机才能正确地存储、读取和解释数据。  
* 命名  
> 给变量命名时要使用有意义的变量名或标识符。如果变量名无法清楚地表达自身的用途，可在注释中进一步说明。这是一种良好的编程习惯和编程技巧。  
> C99和C11允许使用更长的标识符名，但是编译器只识别前63个字符，你可以使用更长的字符，但是编译器会忽略超出的字符。可以用小写字母、大写字母、数字和下划线(_)来命名。而且，名称的第一个字符必须是字符或下划线，不能是数字。操作系统和C库经常使用一个或两个下划线字符开始的标识符，因此最好避免在自己的程序中使用这样的名称。  
6. 赋值  
num=1；  
&emsp;这行代码是赋值表达式语句。赋值是C语言的基本操作之一，改行代码的意思是把"把值1赋给变量num"。在执行int num；声明时，编译器在计算机内存中为变量预留了空间，然后在执行这行赋值表达式语句时，把值存储在之前预留的位置。  
7. printf()函数  
&emsp;圆括号表明printf是一个函数名。圆括号中的内容是从main()函数传递给printf()函数的信息。第一行吧I am a simple传递给printf()函数。该信息被称为参数或者更确切地说，是函数的实际参数，实参是传递给函数的特性值，形式参数是函数中用于存储值的变量。当程序运行到这一行时，控制权被转给已命名的函数(如printf())。函数执行结束后，控制权被返回至主调函数，如main()。  
8. return语句  
&emsp;return语句是程序中的最后一条语句。int main(void)中的int表明main函数应返回一个整数。C标准要求main()这样做。有返回值的C函数要有return语句。该语句以return关键字开始，后面是带返回的值，并以分号结尾。如果遗漏main()函数中的return语句，程序运行至最外面的右花括号时会返回0。
#### 简单程序的结构  
&emsp;C程序由一个或多个函数组成，必须有main()函数，函数由函数头和函数体组成。
* 函数头包括函数名、传入该函数的信息类型和函数的返回类型。
* 函数体被花括号括起来，由一系列语句、声明组成。
####  提高程序可读性技巧  
1. 选择有意义的函数名和写注释。  
2. 在函数中用空行分隔概念上的多个部分。  
3. 尽量每条语句占一行。  
#### 进一步使用C  
[fathm_ft.c](../../c-example/fathm_ft.c)  
1. 该程序在一条声明中声明了两个变量，而不是一个变量，使用逗号隔开两个变量。  
2. 程序进行了乘法运算，使用运算符\*。  
3. 最后使用printf()函数时,进行了两次替换，并且待打印的值不一定是变量，只要可求值得出合适类型值得项即可。如6*fathoms。  
#### 多个函数  
[two_func.c](../../c-example/two_func.c)  
&emsp;two.func.c程序演示了如何把自己的函数加入程序中。  
&emsp;butler()函数在程序中出现了三次。第1次是函数原型(prototype),告知编译器要在程序中使用该函数；第2次以函数调用(function call)的形式出现在main中；最后一次出现在函数定义(function definition)中，函数定义即是函数本身的源代码。  
&emsp;函数原型是一种声明形式，告知编译器正在使用某函数，因此函数原型也被称为函数声明(function declaration)。函数原型还指明了函数的属性。例如，butler()函数原型中的第1个void表明，butler()函数没有返回值。第二个void的意思是butler()函数不带参数。  
&emsp;C标准建议，要为程序中用到的所有函数提供函数原型。标准include文件为标准库函数提供可函数原型。例如，在C标准中，stdio.h文件包含了printf()的函数原型。  
#### 调试程序  
``` C
/* nogood.c --有错误的程序 */
#include <stdio.h>  

int main(void)(
    int n,int n2, int n3;
    /* 该程序有多处错误
    n = 5;
    n2 = n * n;
    n3 = n2*n2;
    printf("n=%d,n squared = %d, n cubed = %d\n",n,n2,n3)
    return 0;
)
```  
1. 语法错误  
&emsp;上述程序中有多处语法错误。不遵循C语言的规则就会犯语法错误。其一，main()函数体使用圆括号来代替花括号。二是变量声明错误，三是注释漏掉了*/结尾。最后printf()语句末尾漏掉了分号。  
2. 语义错误  
&emsp;编译器无法检测语义错误，因为这类错误并未违反C语言的规则。编译器无法了解你的真正意图。所以你只能自己找出这些错误。  
[stillbad.c](../../c-example/stillbad.c)  
3. 程序状态  
&emsp;通过逐步跟踪程序的执行步骤，并记录每个变量，便可监视程序的状态。程序状态(program state)是在程序的执行过程中，某给定点上所有变量值的集合。  
&emsp;定义语义错误的另一种方法是：在程序中的关键点插入额外的printf()语句，以监视制定变量值的变化。通过查看值得变化可以了解程序的执行情况，对程序的执行满意后，便可删除额外的printf()语句，然后重新编译。  
&emsp;检测程序状态的第三种方法是使用调试器。调试器(debugger)是一种程序，让你一步一步运行另一个程序，并检查该程序变量的值。调试器有不同的使用难度和复杂度。较高级的调试器会显示正在执行的源代码行号。  
4. 关键字和保留标识符  
&emsp;关键字是C语言词汇。它们对C而言比较特殊，不能用它们作为标识符。许多关键字用于指定不同的类型，如int。还有一些关键字(如if)用于控制程序中语句的执行顺序。  
### 3. 数据和C
#### 示例程序  
[platinum.c](../../c-example/platimun.c)  
&emsp;即使使用第2章介绍的方法，在程序中添加下面一行代码:  
``` C
getchar();  
```
&emsp;程序的输出是否依旧在屏幕上一闪而过？本例，需要调用两次getchar()函数：  
&emsp;getchar()函数读取下一个输入字符，因此程序会等待用户输入。在这种情况下，键入156并按下Enter键(发送一个换行符)，然后scanf()读取键入的数字，第1个getchar()读取换行符，第二个getchar()让程序暂停，等待输入。  
&emsp;代码中使用了一种新的变量声明。前面的例子中只使用了整数类型的变量(int)，但是本例使用了浮点数类型(float)的变量，以便处理更大范围的数据。float类型可以存储带小数的数字。  
为了打印新类型的变量，在printf()中使用%f来处理浮点值。%.2f中的.2用于精确控制输出，指定输出的浮点数只显示小数点后两位。  
&emsp;scanf()函数用于读取键盘的输入。%f说明scanf()要读取用户从键盘输入的浮点数，&weight告诉scanf()把输入的值赋给名为weight的变量。  
#### 变量与常量数据  
&emsp;要完成各类任务，程序需要使用数据，即承载信息的数字和字符。有些数据类型在程序使用之前已经预先设定好了，在程序运行过程中没有变化，这些称为常量(constant)。其他数据类型在程序运行期间可能会改变或被赋值，这些称为变量(variable)。在示例程序中，weight是一个变量，14.5833是一个常量。那么1700.0是常量还是变量？在现实生活中，白金的价格不会是常量，但是在程序中，像1700.0这样的价格被视为常量。

